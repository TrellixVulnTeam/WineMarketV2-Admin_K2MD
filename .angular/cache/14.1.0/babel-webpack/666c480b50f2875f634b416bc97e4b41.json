{"ast":null,"code":"import { FormControl, FormGroup } from '@angular/forms';\nimport { User } from 'src/app/entity/user.entity';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/service/user/user.service\";\nimport * as i2 from \"src/app/service/utils/upload.service\";\nimport * as i3 from \"src/app/service/utils/message.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\n\nfunction UserComponent_button_31_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 37);\n    i0.ɵɵlistener(\"click\", function UserComponent_button_31_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.onUpdate(ctx_r5.user.id));\n    });\n    i0.ɵɵtext(1, \"Update\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction UserComponent_button_32_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 37);\n    i0.ɵɵlistener(\"click\", function UserComponent_button_32_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.onCreate());\n    });\n    i0.ɵɵtext(1, \"Add\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction UserComponent_button_33_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 37);\n    i0.ɵɵlistener(\"click\", function UserComponent_button_33_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.onDelete(ctx_r9.user.id));\n    });\n    i0.ɵɵtext(1, \"Delete\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction UserComponent_button_34_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 37);\n    i0.ɵɵlistener(\"click\", function UserComponent_button_34_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.clearUserForm());\n    });\n    i0.ɵɵtext(1, \"Cancel\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction UserComponent_tr_72_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\")(10, \"a\", 38);\n    i0.ɵɵlistener(\"click\", function UserComponent_tr_72_Template_a_click_10_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r16);\n      const user_r13 = restoredCtx.$implicit;\n      const ctx_r15 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r15.onEdit(user_r13.id));\n    });\n    i0.ɵɵelement(11, \"i\", 39);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"a\", 38);\n    i0.ɵɵlistener(\"click\", function UserComponent_tr_72_Template_a_click_12_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r16);\n      const user_r13 = restoredCtx.$implicit;\n      const ctx_r17 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r17.onDelete(user_r13.id));\n    });\n    i0.ɵɵelement(13, \"i\", 40);\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const user_r13 = ctx.$implicit;\n    const i_r14 = ctx.index;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i_r14 + 1);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(user_r13.username);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(user_r13.email);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(user_r13.role ? \"Admin\" : \"User\");\n  }\n}\n\nexport let UserComponent = /*#__PURE__*/(() => {\n  class UserComponent {\n    constructor(userService, uploadService, messageService) {\n      this.userService = userService;\n      this.uploadService = uploadService;\n      this.messageService = messageService;\n      this.fileName = '';\n      this.userForm = new FormGroup({\n        Username: new FormControl(),\n        Image: new FormControl(),\n        Email: new FormControl(),\n        Role: new FormControl()\n      });\n      this.filterForm = new FormGroup({\n        Username: new FormControl(),\n        Email: new FormControl(),\n        Role: new FormControl()\n      });\n    }\n\n    ngOnInit() {\n      this.user = new User('', '', '', '', 'null.png', true);\n      this.fileName = 'null.png';\n      this.userService.getAll().subscribe(res => {\n        this.users = res;\n      }, err => {\n        console.log(err);\n        this.messageService.showError('Failed to load List user');\n      });\n    }\n\n    onUpdate(id) {\n      var image = new FormData();\n\n      if (this.userForm.controls['Image'].value != null) {\n        image.append('file', this.userForm.controls['Image'].value);\n        this.uploadService.uploadImage(image, 'user').subscribe(error => {\n          console.log(error);\n        });\n      }\n\n      var username = this.userForm.controls['Username'].value == null ? this.user.username : this.userForm.controls['Username'].value;\n      var img = this.fileName == 'null.png' ? this.user.image : this.fileName.replace(\" \", \"%20\");\n      var email = this.userForm.controls['Email'].value == null ? this.user.email : this.userForm.controls['Email'].value;\n      var role = this.userForm.controls['Role'].value == null ? this.user.role : this.userForm.controls['Role'].value;\n      var user = new User(id, username, this.user.password, email, img, role);\n      this.userService.update(user).subscribe(data => {\n        this.messageService.showSuccess('Update user success.');\n        this.clearUserForm();\n        this.clearFilterForm();\n      }, error => {\n        this.messageService.showError('Update user failed');\n        this.clearUserForm();\n        this.clearFilterForm();\n      });\n    }\n\n    onCreate() {\n      var image = new FormData();\n\n      if (this.userForm.controls['Image'].value != null) {\n        image.append('file', this.userForm.controls['Image'].value);\n        this.uploadService.uploadImage(image, 'user').subscribe(error => {\n          console.log(error);\n        });\n      }\n\n      var username = this.userForm.controls['Username'].value == null ? this.user.username : this.userForm.controls['Username'].value;\n      var img = this.fileName == 'null.png' ? this.user.image : this.fileName.replace(\" \", \"%20\");\n      var email = this.userForm.controls['Email'].value == null ? this.user.email : this.userForm.controls['Email'].value;\n      var role = this.userForm.controls['Role'].value == null ? this.user.role : this.userForm.controls['Role'].value;\n      var user = new User(\"\", username, this.user.password, email, img, role);\n      this.userService.create(user).subscribe(data => {\n        this.messageService.showSuccess('Create user success.');\n        this.clearUserForm();\n        this.clearFilterForm();\n      }, error => {\n        this.messageService.showError('Create user failed');\n        this.clearUserForm();\n        this.clearFilterForm();\n        console.log(error);\n      });\n    }\n\n    onDelete(id) {\n      this.userService.delete(id).subscribe(res => {\n        this.messageService.showSuccess('Delete user success.');\n        this.clearUserForm();\n        this.clearFilterForm();\n      }, err => {\n        console.log(err);\n        this.messageService.showError('Delete user failed.');\n        this.clearUserForm();\n        this.clearFilterForm();\n      });\n    }\n\n    onEdit(id) {\n      this.userService.find(id).subscribe(res => {\n        this.user = res;\n        this.fileName = this.user.image;\n      }, err => {\n        console.log(err);\n      });\n    }\n\n    onFilter() {\n      var username = this.filterForm.controls['Username'].value == null ? \"\" : this.filterForm.controls['Username'].value;\n      var email = this.filterForm.controls['Email'].value == null ? \"\" : this.filterForm.controls['Email'].value;\n      var role = this.filterForm.controls['Role'].value == null ? \"\" : this.filterForm.controls['Role'].value;\n      this.userService.filter(username, email, role).subscribe(res => {\n        this.users = res;\n      }, err => {\n        this.users = new Array();\n      });\n    }\n\n    clearUserForm() {\n      this.userForm.reset();\n      this.user = new User('', '', '', '', 'null.png', false);\n    }\n\n    clearFilterForm() {\n      // this.filterForm.reset()\n      // this.userService.getAll().subscribe(\n      //   res => {\n      //     this.users = res\n      //   },\n      //   err => {\n      //     console.log(err)\n      //     this.messageService.showError('Failed to load List user')\n      //   }\n      // )\n      window.location.reload();\n    }\n\n    onFileSelected(event) {\n      const target = event.target;\n\n      if (target.files && target.files.length > 0) {\n        const file = target.files[0];\n        this.fileName = file.name;\n        this.userForm.patchValue({\n          Image: file\n        });\n      }\n    }\n\n  }\n\n  UserComponent.ɵfac = function UserComponent_Factory(t) {\n    return new (t || UserComponent)(i0.ɵɵdirectiveInject(i1.UserService), i0.ɵɵdirectiveInject(i2.UploadService), i0.ɵɵdirectiveInject(i3.MessageService));\n  };\n\n  UserComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: UserComponent,\n    selectors: [[\"app-user\"]],\n    decls: 73,\n    vars: 12,\n    consts: [[1, \"container-fluid\", \"pt-4\", \"px-4\"], [1, \"row\", \"g-4\"], [1, \"col-sm-12\", \"col-xl-6\"], [1, \"bg-light\", \"rounded\", \"h-100\", \"p-4\"], [1, \"mb-4\"], [\"enctype\", \"multipart/form-data\", 3, \"formGroup\"], [1, \"mb-3\"], [\"for\", \"exampleInputEmail1\", 1, \"form-label\"], [\"type\", \"text\", \"formControlName\", \"Username\", 1, \"form-control\", 3, \"value\"], [\"for\", \"formFile\", 1, \"form-label\"], [\"formControlName\", \"Image\", \"type\", \"file\", \"id\", \"formFile\", 1, \"form-control\", 3, \"change\"], [\"type\", \"email\", \"formControlName\", \"Email\", \"id\", \"exampleInputEmail1\", \"aria-describedby\", \"emailHelp\", 1, \"form-control\", 3, \"value\"], [1, \"row\"], [1, \"form-check\", \"form-check-inline\"], [\"type\", \"radio\", \"id\", \"inlineRadio1\", \"formControlName\", \"Role\", \"value\", \"true\", 1, \"form-check-input\", 3, \"checked\"], [\"for\", \"inlineRadio1\", 1, \"form-check-label\"], [\"type\", \"radio\", \"id\", \"inlineRadio2\", \"formControlName\", \"Role\", \"value\", \"false\", 1, \"form-check-input\", 3, \"checked\"], [\"for\", \"inlineRadio2\", 1, \"form-check-label\"], [\"class\", \"btn btn-primary m-2\", 3, \"click\", 4, \"ngIf\"], [1, \"bg-light\", \"rounded\", \"h-100\", \"p-4\", \"align-items-center\", \"justify-content-center\", \"mx-0\"], [\"alt\", \"none\", 1, \"rounded\", \"mx-auto\", \"d-block\", 2, \"width\", \"60%\", 3, \"src\"], [1, \"col-sm-12\", \"col-xl-12\"], [1, \"d-none\", \"d-md-flex\", 3, \"formGroup\", \"ngSubmit\"], [\"type\", \"text\", \"formControlName\", \"Username\", \"placeholder\", \"Search by Username\", 1, \"form-control\", \"border-0\", \"ms-3\"], [\"type\", \"email\", \"formControlName\", \"Email\", \"placeholder\", \"Search by Email\", 1, \"form-control\", \"border-0\", \"ms-3\"], [\"formControlName\", \"Role\", \"aria-label\", \"Default select example\", 1, \"form-select\", \"ms-3\"], [\"disabled\", \"\"], [\"value\", \"true\"], [\"value\", \"false\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", \"ms-3\"], [1, \"fas\", \"fa-filter\"], [1, \"btn\", \"btn-primary\", \"ms-3\", 3, \"click\"], [1, \"fas\", \"fa-times\"], [1, \"table-wrapper-scroll-y\", \"my-custom-scrollbar\"], [1, \"table\", \"table-hover\"], [\"scope\", \"col\"], [4, \"ngFor\", \"ngForOf\"], [1, \"btn\", \"btn-primary\", \"m-2\", 3, \"click\"], [1, \"btn\", \"btn-primary\", \"me-1\", 3, \"click\"], [1, \"fas\", \"fa-edit\"], [1, \"fas\", \"fa-trash\"]],\n    template: function UserComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"h6\", 4);\n        i0.ɵɵtext(5, \"User\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"form\", 5)(7, \"div\", 6)(8, \"label\", 7);\n        i0.ɵɵtext(9, \"Username\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(10, \"input\", 8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"div\", 6)(12, \"label\", 9);\n        i0.ɵɵtext(13, \"Image\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"input\", 10);\n        i0.ɵɵlistener(\"change\", function UserComponent_Template_input_change_14_listener($event) {\n          return ctx.onFileSelected($event);\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(15, \"div\", 6)(16, \"label\", 7);\n        i0.ɵɵtext(17, \"Email\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(18, \"input\", 11);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(19, \"div\", 6)(20, \"div\", 12)(21, \"label\", 7);\n        i0.ɵɵtext(22, \"Role\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(23, \"div\", 13);\n        i0.ɵɵelement(24, \"input\", 14);\n        i0.ɵɵelementStart(25, \"label\", 15);\n        i0.ɵɵtext(26, \"Admin\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(27, \"div\", 13);\n        i0.ɵɵelement(28, \"input\", 16);\n        i0.ɵɵelementStart(29, \"label\", 17);\n        i0.ɵɵtext(30, \"User\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵtemplate(31, UserComponent_button_31_Template, 2, 0, \"button\", 18);\n        i0.ɵɵtemplate(32, UserComponent_button_32_Template, 2, 0, \"button\", 18);\n        i0.ɵɵtemplate(33, UserComponent_button_33_Template, 2, 0, \"button\", 18);\n        i0.ɵɵtemplate(34, UserComponent_button_34_Template, 2, 0, \"button\", 18);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(35, \"div\", 2)(36, \"div\", 19);\n        i0.ɵɵelement(37, \"img\", 20);\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(38, \"div\", 0)(39, \"div\", 1)(40, \"div\", 21)(41, \"div\", 3)(42, \"div\", 12)(43, \"form\", 22);\n        i0.ɵɵlistener(\"ngSubmit\", function UserComponent_Template_form_ngSubmit_43_listener() {\n          return ctx.onFilter();\n        });\n        i0.ɵɵelement(44, \"input\", 23)(45, \"input\", 24);\n        i0.ɵɵelementStart(46, \"select\", 25)(47, \"option\", 26);\n        i0.ɵɵtext(48, \"--Role--\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(49, \"option\", 27);\n        i0.ɵɵtext(50, \"Admin\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(51, \"option\", 28);\n        i0.ɵɵtext(52, \"User\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(53, \"button\", 29);\n        i0.ɵɵelement(54, \"i\", 30);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(55, \"button\", 31);\n        i0.ɵɵlistener(\"click\", function UserComponent_Template_button_click_55_listener() {\n          return ctx.clearFilterForm();\n        });\n        i0.ɵɵelement(56, \"i\", 32);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(57, \"div\", 33)(58, \"table\", 34)(59, \"thead\")(60, \"tr\")(61, \"th\", 35);\n        i0.ɵɵtext(62, \"#\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(63, \"th\", 35);\n        i0.ɵɵtext(64, \"Username\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(65, \"th\", 35);\n        i0.ɵɵtext(66, \"Email\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(67, \"th\", 35);\n        i0.ɵɵtext(68, \"Role\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(69, \"th\", 35);\n        i0.ɵɵtext(70, \"Action\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(71, \"tbody\");\n        i0.ɵɵtemplate(72, UserComponent_tr_72_Template, 14, 4, \"tr\", 36);\n        i0.ɵɵelementEnd()()()()()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"formGroup\", ctx.userForm);\n        i0.ɵɵadvance(4);\n        i0.ɵɵpropertyInterpolate(\"value\", ctx.user.username);\n        i0.ɵɵadvance(8);\n        i0.ɵɵpropertyInterpolate(\"value\", ctx.user.email);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"checked\", ctx.user.role);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"checked\", !ctx.user.role);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.user.id != \"\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.user.id == \"\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.user.id != \"\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.user.id != \"\");\n        i0.ɵɵadvance(3);\n        i0.ɵɵpropertyInterpolate1(\"src\", \"https://res.cloudinary.com/winemarket/image/upload/v1659403526/winemarket/user/\", ctx.user.image, \"\", i0.ɵɵsanitizeUrl);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"formGroup\", ctx.filterForm);\n        i0.ɵɵadvance(29);\n        i0.ɵɵproperty(\"ngForOf\", ctx.users);\n      }\n    },\n    dependencies: [i4.NgForOf, i4.NgIf, i5.ɵNgNoValidate, i5.NgSelectOption, i5.ɵNgSelectMultipleOption, i5.DefaultValueAccessor, i5.SelectControlValueAccessor, i5.RadioControlValueAccessor, i5.NgControlStatus, i5.NgControlStatusGroup, i5.FormGroupDirective, i5.FormControlName],\n    encapsulation: 2\n  });\n  return UserComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}